var quform=function(e,i,o,s){"use strict";var t,b=e.core,a=b.cache,n=i(document);function r(t){a.get("#qfb-entry-label-set").find(".qfb-entry-label").removeClass("qfb-label-selected").each(function(){var e=i(this);t.find(".qfb-entry-label-indicator").each(function(){i(this).data("id")==e.data("label").id&&e.addClass("qfb-label-selected")})}),a.get("#qfb-entry-label-set").show()}return i((t={init:function(){a.get(".qfb-entry-label-indicators").click(function(e){e.stopPropagation();var t=i(this),n=t.parent();a.get("#qfb-entry-label-set").parent()[0]===n[0]?a.get("#qfb-entry-label-set").is(":visible")?a.get("#qfb-entry-label-set").hide():r(t):(n.append(a.get("#qfb-entry-label-set").hide()),r(t))}),n.on("click",function(e){e&&e.which&&3===e.which||a.get("#qfb-entry-label-set").hide()}),a.get("#qfb-entry-label-set").click(function(e){e.stopPropagation()}),a.get("#qfb-entry-label-set").find(".qfb-entry-label").click(function(){t.setEntryLabel(i(this))}),n.on("heartbeat-tick",function(e,t){t&&t.nonces_expired&&t.quformSetEntryLabelsNonce&&o.setEntryLabelsNonce!==t.quformSetEntryLabelsNonce&&(o.setEntryLabelsNonce=t.quformSetEntryLabelsNonce)})},setEntryLabel:function(e){e.toggleClass("qfb-label-selected");var t=e.data("label"),n=e.hasClass("qfb-label-selected"),a=e.closest("th, td"),r=a.find(".qfb-entry-label-indicators");if(n){if(t.color){var l=i('<span class="qfb-entry-label-indicator">').data("id",t.id).css("background-color",t.color);b.isColorTransparent(t.color)&&l.addClass("qfb-entry-label-indicator-transparent"),b.isNonEmptyString(t.name)&&l.attr("title",t.name),r.append(l),r.find(".qfb-entry-label-indicator:not(.qfb-entry-label-indicator-transparent)").length&&r.find(".qfb-entry-no-labels").hide()}}else r.find(".qfb-entry-label-indicator").filter(function(){return i(this).data("id")==t.id}).remove(),r.find(".qfb-entry-label-indicator:not(.qfb-entry-label-indicator-transparent)").length||r.find(".qfb-entry-no-labels").show();i.ajax({url:s.ajaxUrl,type:"POST",dataType:"json",data:{action:"quform_set_entry_labels",_ajax_nonce:o.setEntryLabelsNonce,entry_id:a.data("entry-id"),entry_label_id:t.id,adding:n}}).done(function(e){"error"===(e=b.sanitizeResponse(e)).type&&b.showFixedMessage(o.errorSettingEntryLabel+"<br>"+e.message,"error")})}}).init),e.entries=t,e}(quform,jQuery,quformEntriesL10n,quformCoreL10n);